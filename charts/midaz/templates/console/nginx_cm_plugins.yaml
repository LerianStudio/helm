apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "midaz-console.fullname" . }}-nginx-config-plugins
data:
  plugins.conf: |-
{{- if and .Values.console.pluginsUi.enabled .Values.console.pluginsUi.plugins }}
{{- range $name, $plugin := .Values.console.pluginsUi.plugins }}
{{- if $plugin.enabled }}
{{-   $context := dict "name" $name "port" $plugin.port }}
{{ tpl (include "nginx.pluginServerBlock" $context) $ | indent 4 }}
{{- end }}
{{- end }}
{{- end }}